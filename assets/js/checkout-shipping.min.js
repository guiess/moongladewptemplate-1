!function(){const cartDOMElement=document.querySelector(".js-cart");if(!cartDOMElement)return;const cart=JSON.parse(localStorage.getItem("cart"))||new Object,customer=JSON.parse(localStorage.getItem("customer"))||new Object;let discountValue=Number(customer.discountValue)||0,discountCode=customer.discountCode||"",deliveryPrice=customer.deliveryPrice||0;const cartSubtotalPriceDOMElement=document.querySelector(".js-cart-subtotal-price"),cartTotalPriceDOMElement=document.querySelector(".js-cart-total-price"),cartDiscountSumDOMElement=document.querySelector(".js-discount-sum"),cartDeliveryDOMElement=document.querySelector(".js-delivery-sum"),hiddenFormEmptyCart=document.querySelector(".hidden-form-empty-cart"),renderCartItem=({id:id,name:name,src:src,price:price,quantity:quantity,weight:weight,weightOz:weightOz})=>{const cartItemDOMElement=document.createElement("div"),summitem=price*quantity,cartItemTemplate=`\n      <div class="cart-product uppercase flex items-start">\n        <div class="cart-product__visual overflow-hidden flex-shrink-0">\n          <picture>\n          <img class="w-full max-w-full transition-opacity duration-300 entered loaded" data-component="lazyload" data-animate="data-animate" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 9'%3E%3C/svg%3E" data-srcset="${src}" alt="image description" data-ll-status="loaded" srcset="${src}">\n          </picture>\n        </div>\n        <div class="flex-grow">\n          <h4 class="cart-product__title laptop:w-8/12">${name}</h4>\n          <div class="cart-product__info-line flex justify-between items-baseline">\n            <div class="cart-product__info-item">\n              <span class="font-moonglade">$ ${price}</span><span class="opacity-50 weight lowercase font-moonglade">(${weight}g / ${weightOz}oz)</span>\n            </div>\n            <div class="cart-product__info-item"><span class="js-cart-item-price">$ ${summitem}</span></div>\n          </div>\n          <div class="flex justify-between items-center">\n            <div class="cart-product__info-item">\n              <div class="stepper" data-component="stepper" data-min="1" data-max="99" data-step="1">\n                <div class="stepper__control stepper__control--decrease" data-decrement=""><i class="js-btn-product-decrease-quantity"></i></div>\n                <input class="stepper__input js-cart-item-quantity" readonly type="number" data-input="" value="${quantity}" />\n                <div class="stepper__control stepper__control--increase" data-increment=""><i class="js-btn-product-increase-quantity"></i></div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;cartItemDOMElement.innerHTML=cartItemTemplate,cartItemDOMElement.setAttribute("data-product-id",id),cartItemDOMElement.classList.add("js-cart-item"),cartDOMElement.appendChild(cartItemDOMElement)},saveCart=()=>{localStorage.setItem("cart",JSON.stringify(cart))},saveCustomer=()=>{localStorage.setItem("customer",JSON.stringify(customer))},updateCartTotalPrice=()=>{if(cartEmpty())return;let discountValueMath;const totalPrice=Object.keys(cart).reduce((acc,id)=>{const{quantity:quantity,price:price}=cart[id];return acc+price*quantity},0);document.getElementById("discountInputField").value=discountCode,cartSubtotalPriceDOMElement&&(cartSubtotalPriceDOMElement.textContent="$ "+totalPrice),discountValueMath=discountValue<0?Math.abs(discountValue):Math.abs(discountValue)/100*totalPrice,discountValueMath=Math.round(discountValueMath),cartDiscountSumDOMElement&&(cartDiscountSumDOMElement.textContent=discountValueMath?"$ -"+discountValueMath:"$ 0"),customer.deliveryPrice&&Object.keys(cart).length&&(cartDeliveryDOMElement.textContent="$ "+customer.deliveryPrice),cartTotalPriceDOMElement&&(cartTotalPriceDOMElement.textContent="$ "+(Number(totalPrice)-discountValueMath+Number(deliveryPrice)))},disableDiscountApplyBtn=()=>{discountCode&&$(".js-button-apply-disount").removeAttr("disabled")},updateCart=()=>{updateCartTotalPrice(),disableDiscountApplyBtn(),saveCart(),itemWrapFull=document.getElementById("js-cart-wrapper-full"),itemWrapEmpty=document.getElementById("js-cart-wrapper-empty")},countItemsInCart=()=>{const count=Object.keys(cart).length;return count},renderCart=()=>{if(cartEmpty())return;const ids=Object.keys(cart);ids.forEach(id=>renderCartItem(cart[id]))},saveDataCustomer=customerForm=>{const email=customerForm.elements.customerShippingEmail.value,address=customerForm.elements.customerShippingAddress.value;customer.shippingEmail=email,customer.shippingAddress=address,saveCustomer(),location.href="WPJS/checkout-payment"},renderForm=()=>{if(customer){const customerForm=document.forms.customerinfo;customer.email?customerForm.customerShippingEmail.value=customer.email:customerForm.customerShippingEmail.value="",customer.address?customerForm.customerShippingAddress.value=customer.postalCode+", "+customer.countryName+", "+customer.province+", "+customer.city+", "+customer.address+" "+customer.apartment:customerForm.customerShippingAddress.value=""}},makeDiscount=discount=>{discountValue=Math.abs(Number(discount.substr(3))),discountCode=document.getElementById("discountInputField").value,discount.startsWith("fix")&&(discountValue*=-1),customer.discountCode=discountCode,customer.discountValue=discountValue,saveCustomer(),updateCartTotalPrice()},discountCheck=function(){if(!cartEmpty()){var xhr=new XMLHttpRequest,url=WPJS.ajaxUrl+"?action=discount_check";xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){const response=xhr.response;"false"!==response&&(response.startsWith("fix")||response.startsWith("per"))&&makeDiscount(response)},discountCode=document.getElementById("discountInputField").value,xhr.send("discountcode="+discountCode)}},renderDelivery=function(){if(!cartEmpty()&&customer.country&&customer.city&&customer.postalCode){var xhr=new XMLHttpRequest,url=WPJS.ajaxUrl+"?action=delivery_rank";xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){const response=xhr.response;for(console.log(response),responseJSON=JSON.parse(response),i=0;i<responseJSON.price.length;i++){let selectedOption=document.getElementById("customerSelectShippingMethod"),newOption=new Option(responseJSON.shippingmethod[i]+" $"+responseJSON.price[i],responseJSON.shippingcode[i]);newOption.setAttribute("data-price",responseJSON.price[i]),newOption.setAttribute("data-shippingmethod",responseJSON.shippingmethod[i]),responseJSON.shippingcode[i]==customer.deliveryCode&&newOption.setAttribute("selected","selected"),selectedOption.append(newOption)}},infoToSend=`country=${customer.country}&city=${customer.city}&postalcode=${customer.postalCode}`,xhr.send(infoToSend)}},cartEmpty=function(){return!Object.keys(cart).length},cartIsEmptyPlug=function(){emptyCartDOMelement=document.querySelector(".js-cart-is-empty-plug");const cartEmptyPlug='\n    <p class="uppercase opacity-50 text-center w-full cart-popup__empty-message">\n      <br><br><br><br><br>\n      It appears that your cart <br>\n      is currently empty!\n      <br><br><br><br><br>  \n    </p>\n    ';emptyCartDOMelement.innerHTML=cartEmptyPlug},allListeners=()=>{document.querySelector("body").addEventListener("click",e=>{const target=e.target;if(target.classList.contains("js-button-apply-disount")&&discountCheck(),target.classList.contains("js-btn-continue")){e.preventDefault();const customerForm=document.forms.customerinfo;if(!checkValidityOurFunc(customerForm))return;saveDataCustomer(customerForm)}})},cartInit=()=>{if(allListeners(),cartEmpty())return cartIsEmptyPlug(),void(hiddenFormEmptyCart.hidden=!0);renderForm(),renderCart(),updateCart(),renderDelivery();const selectElement=document.getElementById("customerSelectShippingMethod");selectElement.addEventListener("change",()=>{deliveryMethodText=selectElement.options[selectElement.selectedIndex].getAttribute("data-shippingmethod"),customer.deliveryMethodText=deliveryMethodText,deliveryCode=selectElement.options[selectElement.selectedIndex].value,customer.deliveryCode=deliveryCode,deliveryPrice=selectElement.options[selectElement.selectedIndex].getAttribute("data-price"),customer.deliveryPrice=deliveryPrice,updateCartTotalPrice()})};cartInit()}();const checkValidityOurFunc=customerForm=>{if(customerForm.customerShippingEmail.checkValidity())if(customerForm.customerShippingAddress.checkValidity()){if("Other"!=customerForm.customerSelectShippingMethod.value)return!0;alert("Please select your Shipping Method")}else alert("Please check your Shipping Address spelling");else alert("Please check your email spelling")};