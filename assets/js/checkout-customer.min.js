!function(){const cartDOMElement=document.querySelector(".js-cart");if(!cartDOMElement)return;const cart=JSON.parse(localStorage.getItem("cart"))||new Object,customer=JSON.parse(localStorage.getItem("customer"))||new Object;let discountValue=Number(customer.discountValue)||0,discountCode=customer.discountCode||"";customer.deliveryPrice||(customer.deliveryPrice=0);const updateQuantity=(id,quantity)=>{const cartItemDOMElement=cartDOMElement.querySelector(`[data-product-id="${id}"]`),cartItemQuantityDOMElement=cartItemDOMElement.querySelector(".js-cart-item-quantity"),cartItemPriceDOMElement=cartItemDOMElement.querySelector(".js-cart-item-price");cart[id].quantity=quantity,cartItemQuantityDOMElement.value=quantity,cartItemPriceDOMElement.textContent="$ "+quantity*cart[id].price,updateCart()},increaseQuantity=(id,quantity)=>{const newQuantity=Number(cart[id].quantity)+Number(quantity);newQuantity<=99&&updateQuantity(id,newQuantity)},decreaseQuantity=id=>{const newQuantity=cart[id].quantity-1;newQuantity>=1&&updateQuantity(id,newQuantity)},cartSubtotalPriceDOMElement=document.querySelector(".js-cart-subtotal-price"),cartTotalPriceDOMElement=document.querySelector(".js-cart-total-price"),cartDiscountSumDOMElement=document.querySelector(".js-discount-sum"),cartDeliverySumDOMElement=document.querySelector(".js-delivery-sum"),hiddenFormEmptyCart=document.querySelector(".hidden-form-empty-cart"),renderCartItem=({id:id,name:name,src:src,price:price,quantity:quantity,weight:weight,weightOz:weightOz})=>{const cartItemDOMElement=document.createElement("div"),summitem=price*quantity,cartItemTemplate=`\n      <div class="cart-product uppercase flex items-start">\n        <div class="cart-product__visual overflow-hidden flex-shrink-0">\n          <picture>\n          <img class="w-full max-w-full transition-opacity duration-300 entered loaded" data-component="lazyload" data-animate="data-animate" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 9'%3E%3C/svg%3E" data-srcset="${src}" alt="image description" data-ll-status="loaded" srcset="${src}">\n          </picture>\n        </div>\n        <div class="flex-grow">\n          <h4 class="cart-product__title laptop:w-8/12">${name}</h4>\n          <div class="cart-product__info-line flex justify-between items-baseline">\n            <div class="cart-product__info-item">\n              <span class="font-moonglade">$ ${price}</span><span class="opacity-50 weight lowercase font-moonglade">(${weight}g / ${weightOz}oz)</span>\n            </div>\n            <div class="cart-product__info-item"><span class="js-cart-item-price">$ ${summitem}</span></div>\n          </div>\n          <div class="flex justify-between items-center">\n            <div class="cart-product__info-item">\n              <div class="stepper" data-component="stepper" data-min="1" data-max="99" data-step="1">\n                <div class="stepper__control stepper__control--decrease" data-decrement=""><i class="icon-minus js-btn-product-decrease-quantity"></i></div>\n                <input class="stepper__input js-cart-item-quantity" readonly type="number" data-input="" value="${quantity}" />\n                <div class="stepper__control stepper__control--increase" data-increment=""><i class="icon-plus js-btn-product-increase-quantity"></i></div>\n              </div>\n            </div>\n            <div class="cart-product__info-item flex"><span class="link link--underline opacity-30 js-btn-cart-item-remove"">remove</span></div>\n          </div>\n        </div>\n      </div>\n    `;cartItemDOMElement.innerHTML=cartItemTemplate,cartItemDOMElement.setAttribute("data-product-id",id),cartItemDOMElement.classList.add("js-cart-item"),cartDOMElement.appendChild(cartItemDOMElement)},saveCart=()=>{localStorage.setItem("cart",JSON.stringify(cart))},saveCustomer=()=>{localStorage.setItem("customer",JSON.stringify(customer))},updateCartTotalPrice=()=>{if(cartEmpty())return;let discountValueMath;const totalPrice=Object.keys(cart).reduce((acc,id)=>{const{quantity:quantity,price:price}=cart[id];return acc+price*quantity},0);document.getElementById("discountInputField").value=discountCode,cartSubtotalPriceDOMElement&&(cartSubtotalPriceDOMElement.textContent="$ "+totalPrice),discountValueMath=discountValue<0?Math.abs(discountValue):Math.abs(discountValue)/100*totalPrice,discountValueMath=Math.round(discountValueMath),cartDiscountSumDOMElement&&(cartDiscountSumDOMElement.textContent=discountValueMath?"-$ "+discountValueMath:"$ 0"),customer.deliveryPrice&&(!Object.keys(cart).length||(cartDeliverySumDOMElement.textContent="$ "+customer.deliveryPrice)),cartTotalPriceDOMElement&&(cartTotalPriceDOMElement.textContent="$ "+(Number(totalPrice)-discountValueMath+Number(customer.deliveryPrice)))},disableDiscountApplyBtn=()=>{discountCode&&$(".js-button-apply-disount").removeAttr("disabled")},updateCart=()=>{updateCartTotalPrice(),disableDiscountApplyBtn(),saveCart()},countItemsInCart=()=>{const count=Object.keys(cart).length;return count},deleteCartItem=id=>{if(1===countItemsInCart())return;const cartItemDOMElement=cartDOMElement.querySelector(`[data-product-id="${id}"]`);cartDOMElement.removeChild(cartItemDOMElement),delete cart[id],updateCart()},renderCart=()=>{if(cartEmpty())return;const ids=Object.keys(cart);ids.forEach(id=>renderCartItem(cart[id]))},saveDataCustomer=customerForm=>{const email=customerForm.elements.customerInfoEmail.value,firstName=customerForm.elements.customerInfoFirstName.value,lastName=customerForm.elements.customerInfoLastName.value,address=customerForm.elements.customerInfoAddress.value,apartment=customerForm.elements.customerInfoApartment.value,countryName=customerForm.customerInfoSelectCountry.options[customerForm.customerInfoSelectCountry.selectedIndex].text,country=customerForm.elements.customerInfoSelectCountry.value,province=customerForm.elements.customerInfoProvince.value,city=customerForm.elements.customerInfoCity.value,postalCode=customerForm.elements.customerInfoPostalCode.value,infoPhone=customerForm.elements.customerInfoPhone.value;customer.email=email,customer.firstName=firstName,customer.lastName=lastName,customer.address=address,customer.apartment=apartment,customer.countryName=countryName,customer.country=country,customer.province=province,customer.city=city,customer.postalCode=postalCode,customer.infoPhone=infoPhone,saveCustomer(),location.href="WPJS/checkout-shipping"},renderForm=()=>{if(customer){const customerForm=document.forms.customerinfo;customer.email?customerForm.customerInfoEmail.value=customer.email:customerForm.customerInfoEmail.value="",customer.firstName?customerForm.customerInfoFirstName.value=customer.firstName:customerForm.customerInfoFirstName.value="",customer.lastName?customerForm.customerInfoLastName.value=customer.lastName:customerForm.customerInfoLastName.value="",customer.address?customerForm.customerInfoAddress.value=customer.address:customerForm.customerInfoAddress.value="",customer.apartment?customerForm.customerInfoApartment.value=customer.apartment:customerForm.customerInfoApartment.value="",customer.country?customerForm.customerInfoSelectCountry.value=customer.country:customerForm.customerInfoSelectCountry.value="placeholder",customer.province?customerForm.elements.customerInfoProvince.value=customer.province:customerForm.elements.customerInfoProvince.value="",customer.city?customerForm.elements.customerInfoCity.value=customer.city:customerForm.elements.customerInfoCity.value="",customer.postalCode?customerForm.customerInfoPostalCode.value=customer.postalCode:customerForm.customerInfoPostalCode.value="",customer.infoPhone?customerForm.customerInfoPhone.value=customer.infoPhone:customerForm.customerInfoPhone.value=""}},makeDiscount=discount=>{discountValue=Math.abs(Number(discount.substr(3))),discountCode=document.getElementById("discountInputField").value,discount.startsWith("fix")&&(discountValue*=-1),customer.discountCode=discountCode,customer.discountValue=discountValue,saveCustomer(),updateCartTotalPrice()},discountCheck=function(){if(!cartEmpty()){var xhr=new XMLHttpRequest,url=WPJS.ajaxUrl+"?action=discount_check";xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){const response=xhr.response;"false"!==response&&(response.startsWith("fix")||response.startsWith("per"))&&makeDiscount(response)},discountCode=document.getElementById("discountInputField").value,xhr.send("discountcode="+discountCode)}},cartEmpty=function(){return!Object.keys(cart).length},cartIsEmptyPlug=function(){emptyCartDOMelement=document.querySelector(".js-cart-is-empty-plug");const cartEmptyPlug='\n    <p class="uppercase opacity-50 text-center w-full cart-popup__empty-message">\n      <br><br><br><br><br>\n      It appears that your cart <br>\n      is currently empty!\n      <br><br><br><br><br>  \n    </p>\n    ';emptyCartDOMelement.innerHTML=cartEmptyPlug},allListeners=()=>{document.querySelector("body").addEventListener("click",e=>{const target=e.target;if(target.classList.contains("js-btn-cart-item-remove")){e.preventDefault();const cartItemDOMElement=target.closest(".js-cart-item"),productID=cartItemDOMElement.getAttribute("data-product-id");deleteCartItem(productID)}if(target.classList.contains("js-btn-product-increase-quantity")){e.preventDefault();const cartItemDOMElement=target.closest(".js-cart-item"),productID=cartItemDOMElement.getAttribute("data-product-id");increaseQuantity(productID,1)}if(target.classList.contains("js-btn-product-decrease-quantity")){const cartItemDOMElement=target.closest(".js-cart-item"),productID=cartItemDOMElement.getAttribute("data-product-id");decreaseQuantity(productID)}if(target.classList.contains("js-button-apply-disount")&&(e.preventDefault(),discountCheck()),target.classList.contains("js-btn-continue")){e.preventDefault();const customerForm=document.forms.customerinfo;if(!checkValidityOurFunc(customerForm))return;saveDataCustomer(customerForm)}})},cartInit=()=>{if(allListeners(),cartEmpty())return cartIsEmptyPlug(),void(hiddenFormEmptyCart.hidden=!0);renderForm(),renderCart(),updateCart()};cartInit()}();const checkValidityOurFunc=customerForm=>{if(customerForm.customerInfoEmail.checkValidity())if(customerForm.customerInfoFirstName.checkValidity())if(customerForm.customerInfoLastName.checkValidity())if(customerForm.customerInfoAddress.checkValidity())if(customerForm.customerInfoApartment.checkValidity())if("placeholder"!==customerForm.customerInfoSelectCountry.value)if(customerForm.customerInfoCity.checkValidity())if(customerForm.customerInfoPostalCode.checkValidity()){if(customerForm.customerInfoPhone.checkValidity())return!0;alert("Please check your Phone spelling")}else alert("Please check your PostalCode spelling");else alert("Please check your City spelling");else alert("Please check your Country spelling");else alert("Please check your Apartment spelling");else alert("Please check your Address spelling");else alert("Please check your LastName spelling");else alert("Please check your FirstName spelling");else alert("Please check your email spelling")};